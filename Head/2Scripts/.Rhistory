Annot$DummyChain = as.numeric(as.factor(Annot$Chain))
View(Annot)
Annot$DummyChain = as.numeric(as.factor(Annot$Chain))-1
View(Annot)
View(Annot)
Annot = Annot[names(Annot) %in% c('trna','DummyChain','TimeBeingSingleStrangedForAll'),]
View(Annot)
Annot = read.table("../../Body/2Derived/MammalianTrnaManualAnnotation.txt", sep = '\t', header = TRUE)
Annot$DummyChain = as.numeric(as.factor(Annot$Chain))-1 # heavy = 0; light = 1
Annot = Annot[col.names(Annot) %in% c('trna','DummyChain','TimeBeingSingleStrangedForAll'),]
Annot = Annot[colnames(Annot) %in% c('trna','DummyChain','TimeBeingSingleStrangedForAll'),]
Annot = read.table("../../Body/2Derived/MammalianTrnaManualAnnotation.txt", sep = '\t', header = TRUE)
Annot$DummyChain = as.numeric(as.factor(Annot$Chain))-1 # heavy = 0; light = 1
View(Annot)
Annot = Annot[colnames(Annot) %in% c('trna','DummyChain','TimeBeingSingleStrangedForAll')]
View(Annot)
nrow(data)
data = merge(data,Annot, by = 'trna')
nrow(data)
View(data)
View(data)
agg = aggregate(data$gibbs, by = list(data$trna,data$DummyChain,data$TimeBeingSingleStrangedForAll), FUN = median)
View(agg)
names(agg) = c('trna','DummyChain','TimeBeingSingleStrangedForAll','MedianGibbs')
agg = agg[order(agg$MedianGibbs),]
View(agg)
LM1 <-lm(MedianGibbs ~ DummyChain + TimeBeingSingleStrangedForAll, data = agg)
summary(LM1)
View(agg)
LM1 <-lm(-MedianGibbs ~ DummyChain + TimeBeingSingleStrangedForAll, data = agg)
summary(LM1)
View(agg)
Annot = read.table("../../Body/2Derived/MammalianTrnaManualAnnotation.txt", sep = '\t', header = TRUE)
Annot$DummyChain = as.numeric(as.factor(Annot$Chain))-1 # heavy = 0; light = 1
View(Annot)
Annot = read.table("../../Body/2Derived/MammalianTrnaManualAnnotation.txt", sep = '\t', header = TRUE)
Annot$DummyLightChain = as.numeric(as.factor(Annot$Chain))-1 # heavy = 0; light = 1
Annot = read.table("../../Body/2Derived/MammalianTrnaManualAnnotation.txt", sep = '\t', header = TRUE)
Annot$LightChain = as.numeric(as.factor(Annot$Chain))-1 # heavy = 0; light = 1
Annot = read.table("../../Body/2Derived/MammalianTrnaManualAnnotation.txt", sep = '\t', header = TRUE)
Annot$GeneCodedOnLightChain = as.numeric(as.factor(Annot$Chain))-1 # heavy = 0; light = 1
Annot = Annot[colnames(Annot) %in% c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll')]
nrow(data)
data = merge(data,Annot, by = 'trna')
nrow(data)
###################################
rm(list=ls(all=TRUE))
data = read.table("../../Body/2Derived/harvest.txt", header = TRUE)
names(data)
### 1 keep only 37
table(data$temp)
nrow(data) # 243476
data = data[data$temp == 37,]
nrow(data) # 81157
### 2 keep only normal tRNA
length(table(data$trna)) # 23 becaus there is 'local' ???
data[data$trna == 'local',]
nrow(data)
data = data[data$trna != 'local',]
nrow(data)
### 3 keep only tRNA with estimated Gibbs Energy (not NA)
str(data)
nrow(data)
data = data[!is.na(data$gibbs),]
nrow(data)
summary(data$gibbs)
### 4 keep only mammals (!!!!!! not ideal!!!!)
Mammals = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", sep = '\t', header = TRUE)
Mammals$Scientific_name = gsub(' ','_',Mammals$Scientific_name)
VecOfMammalianSpecies = unique(Mammals$Scientific_name)
length(VecOfMammalianSpecies)
nrow(data)
data = data[data$species %in% VecOfMammalianSpecies,]
nrow(data)
nrow(data)/22 # ~ 430 species
### 5 read annotation and merge with data
Annot = read.table("../../Body/2Derived/MammalianTrnaManualAnnotation.txt", sep = '\t', header = TRUE)
Annot$GeneCodedOnLightChain = as.numeric(as.factor(Annot$Chain))-1 # heavy = 0; light = 1
Annot = Annot[colnames(Annot) %in% c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll')]
nrow(data)
data = merge(data,Annot, by = 'trna')
nrow(data)
agg = aggregate(data$gibbs, by = list(data$trna,data$GeneCodedOnLightChain,data$TimeBeingSingleStrangedForAll), FUN = median)
names(agg) = c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll','MedianGibbs')
agg = agg[order(agg$MedianGibbs),]
LM1 <-lm(-MedianGibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll, data = agg)
summary(LM1)
summary(lm(-MedianGibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll, data = agg))
summary(lm(-MedianGibbs ~ GeneCodedOnLightChain*TimeBeingSingleStrangedForAll, data = agg))
View(agg)
View(data)
View(agg)
View(data)
View(data)
View(agg)
summary(lm(-gibbs ~ GeneCodedOnLightChain+TimeBeingSingleStrangedForAll, data = data)) # no interaction
rm(list=ls(all=TRUE))
data = read.table("../../Body/2Derived/harvest.txt", header = TRUE)
names(data)
### 1 keep only 37
table(data$temp)
nrow(data) # 243476
data = data[data$temp == 37,]
nrow(data) # 81157
### 2 keep only normal tRNA
length(table(data$trna)) # 23 becaus there is 'local' ???
data[data$trna == 'local',]
nrow(data)
data = data[data$trna != 'local',]
nrow(data)
### 3 keep only tRNA with estimated Gibbs Energy (not NA)
str(data)
nrow(data)
data = data[!is.na(data$gibbs),]
nrow(data)
summary(data$gibbs)
### 4 keep only mammals (!!!!!! not ideal!!!!)
Mammals = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", sep = '\t', header = TRUE)
Mammals$Scientific_name = gsub(' ','_',Mammals$Scientific_name)
View(Mammals)
Mammals = Mammals[names(Mammals) %in% c('Scientific_name','GenerationLength_d')]
View(Mammals)
summary(Mammals$GenerationLength_d)
Mammals = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", sep = '\t', header = TRUE)
Mammals$Scientific_name = gsub(' ','_',Mammals$Scientific_name)
Mammals = Mammals[names(Mammals) %in% c('Scientific_name','GenerationLength_d')]
table(Mammals$GenerationLength_d)
View(data)
Mammals = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", sep = '\t', header = TRUE)
Mammals$species = gsub(' ','_',Mammals$Scientific_name)
Mammals = Mammals[names(Mammals) %in% c('species','GenerationLength_d')]
nrow(data)
data = merge(data,Mammals, by = 'species')
nrow(data)
nrow(data)/22 # ~ 430 species
###################################
rm(list=ls(all=TRUE))
data = read.table("../../Body/2Derived/harvest.txt", header = TRUE)
names(data)
### 1 keep only 37
table(data$temp)
nrow(data) # 243476
data = data[data$temp == 37,]
nrow(data) # 81157
### 2 keep only normal tRNA
length(table(data$trna)) # 23 becaus there is 'local' ???
data[data$trna == 'local',]
nrow(data)
data = data[data$trna != 'local',]
nrow(data)
### 3 keep only tRNA with estimated Gibbs Energy (not NA)
str(data)
nrow(data)
data = data[!is.na(data$gibbs),]
nrow(data)
summary(data$gibbs)
### 4 keep only mammals (!!!!!! not ideal!!!!)
Mammals = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", sep = '\t', header = TRUE)
Mammals$species = gsub(' ','_',Mammals$Scientific_name)
Mammals = Mammals[names(Mammals) %in% c('species','GenerationLength_d')]
nrow(data)
data = merge(data,Mammals, by = 'species')
nrow(data)/22 # ~ 432 species
View(data)
Annot = read.table("../../Body/2Derived/MammalianTrnaManualAnnotation.txt", sep = '\t', header = TRUE)
Annot$GeneCodedOnLightChain = as.numeric(as.factor(Annot$Chain))-1 # heavy = 0; light = 1
Annot = Annot[colnames(Annot) %in% c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll')]
nrow(data)
data = merge(data,Annot, by = 'trna')
nrow(data)
agg = aggregate(data$gibbs, by = list(data$trna,data$GeneCodedOnLightChain,data$TimeBeingSingleStrangedForAll), FUN = median)
names(agg) = c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll','MedianGibbs')
agg = agg[order(agg$MedianGibbs),]
### 7 analysis with 22 values
summary(lm(-MedianGibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll, data = agg))
# if GeneCodedOnLightChain == 1, it means that tRNA after transcription is identical to heavy chain => G and T rich (due to to common transitions: A>G, C>T)
# althougth non-significant, TimeBeingSingleStrangedForAll has positive coefficient, which is expected
summary(lm(-MedianGibbs ~ GeneCodedOnLightChain*TimeBeingSingleStrangedForAll, data = agg)) # no interaction
summary(lm(-gibbs ~ GeneCodedOnLightChain+TimeBeingSingleStrangedForAll, data = data)) # strong effect of all
View(data)
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + GenerationLength_d, data = data))
str(data)
summary(lm(-gibbs ~ (GeneCodedOnLightChain + TimeBeingSingleStrangedForAll)*GenerationLength_d, data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll*GenerationLength_d, data = data))
summary(lm(-scale(gibbs) ~ scale(GeneCodedOnLightChain) + scale(TimeBeingSingleStrangedForAll)*scale(GenerationLength_d), data = data))
summary(lm(-scale(gibbs) ~ scale(GeneCodedOnLightChain) + scale(TimeBeingSingleStrangedForAll)*scale(GenerationLength_d), data = data))
summary(lm(-scale(gibbs) ~ 0 + scale(GeneCodedOnLightChain) + scale(TimeBeingSingleStrangedForAll)*scale(GenerationLength_d), data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll*GenerationLength_d, data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain+TimeBeingSingleStrangedForAll, data = data)) # strong effect of all
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + GenerationLength_d, data = data)) # PIC
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + log2(GenerationLength_d), data = data)) # PIC
summary(lm(-gibbs ~ (GeneCodedOnLightChain + TimeBeingSingleStrangedForAll)*log2(GenerationLength_d), data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll*log2(GenerationLength_d), data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + log2(GenerationLength_d), data = data)) # PIC
summary(lm(-scale(gibbs) ~ scale(GeneCodedOnLightChain) + scale(TimeBeingSingleStrangedForAll)*scale(log2(GenerationLength_d)), data = data))
summary(lm(-scale(gibbs) ~ 0 + scale(GeneCodedOnLightChain) + scale(TimeBeingSingleStrangedForAll)*scale(log2(GenerationLength_d)), data = data))
rm(list=ls(all=TRUE))
data = read.table("../../Body/2Derived/harvest.txt", header = TRUE)
names(data)
### 1 keep only 37
table(data$temp)
nrow(data) # 243476
data = data[data$temp == 37,]
nrow(data) # 81157
### 2 keep only normal tRNA
length(table(data$trna)) # 23 becaus there is 'local' ???
data[data$trna == 'local',]
nrow(data)
data = data[data$trna != 'local',]
nrow(data)
### 3 keep only tRNA with estimated Gibbs Energy (not NA)
str(data)
nrow(data)
data = data[!is.na(data$gibbs),]
nrow(data)
summary(data$gibbs)
### 4 keep only mammals (!!!!!! not ideal!!!!)
Mammals = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", sep = '\t', header = TRUE)
Mammals$species = gsub(' ','_',Mammals$Scientific_name)
Mammals = Mammals[names(Mammals) %in% c('species','GenerationLength_d')]
MedianGenLength = median(Mammals$GenerationLength_d)
MedianGenLength
for (i in 1:nrow(Mammals))  { if (Mammals$GenerationLength_d[i] <= MedianGenLength) {Mammals$LongLived[i] = 0} }
Mammals$LongLived = 1
for (i in 1:nrow(Mammals))  { if (Mammals$GenerationLength_d[i] <= MedianGenLength) {Mammals$LongLived[i] = 0} }
table(Mammals$LongLived)
nrow(data)
data = merge(data,Mammals, by = 'species')
nrow(data)/22 # ~ 432 species
###################################
rm(list=ls(all=TRUE))
data = read.table("../../Body/2Derived/harvest.txt", header = TRUE)
names(data)
### 1 keep only 37
table(data$temp)
nrow(data) # 243476
data = data[data$temp == 37,]
nrow(data) # 81157
### 2 keep only normal tRNA
length(table(data$trna)) # 23 becaus there is 'local' ???
data[data$trna == 'local',]
nrow(data)
data = data[data$trna != 'local',]
nrow(data)
### 3 keep only tRNA with estimated Gibbs Energy (not NA)
str(data)
nrow(data)
data = data[!is.na(data$gibbs),]
nrow(data)
summary(data$gibbs)
### 4 keep only mammals (!!!!!! not ideal!!!!)
Mammals = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", sep = '\t', header = TRUE)
Mammals$species = gsub(' ','_',Mammals$Scientific_name)
Mammals = Mammals[names(Mammals) %in% c('species','GenerationLength_d')]
MedianGenLength = median(Mammals$GenerationLength_d)
Mammals$LongLived = 1
for (i in 1:nrow(Mammals))  { if (Mammals$GenerationLength_d[i] <= MedianGenLength) {Mammals$LongLived[i] = 0} }
table(Mammals$LongLived)
nrow(data)
data = merge(data,Mammals, by = 'species')
nrow(data)/22 # ~ 432 species
Annot = read.table("../../Body/2Derived/MammalianTrnaManualAnnotation.txt", sep = '\t', header = TRUE)
Annot$GeneCodedOnLightChain = as.numeric(as.factor(Annot$Chain))-1 # heavy = 0; light = 1
Annot = Annot[colnames(Annot) %in% c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll')]
nrow(data)
data = merge(data,Annot, by = 'trna')
nrow(data)
agg = aggregate(data$gibbs, by = list(data$trna,data$GeneCodedOnLightChain,data$TimeBeingSingleStrangedForAll), FUN = median)
names(agg) = c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll','MedianGibbs')
agg = agg[order(agg$MedianGibbs),]
summary(lm(-MedianGibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll, data = agg))
summary(lm(-MedianGibbs ~ GeneCodedOnLightChain*TimeBeingSingleStrangedForAll, data = agg)) # no interaction
summary(lm(-gibbs ~ GeneCodedOnLightChain+TimeBeingSingleStrangedForAll, data = data)) # strong effect of all
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + log2(GenerationLength_d), data = data)) # PIC
summary(lm(-gibbs ~ (GeneCodedOnLightChain + TimeBeingSingleStrangedForAll)*log2(GenerationLength_d), data = data))
summary(lm(-gibbs ~ (GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + LongLived, data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + LongLived, data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + log2(TimeBeingSingleStrangedForAll) + LongLived, data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + LongLived, data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll*LongLived, data = data))
###################################
rm(list=ls(all=TRUE))
data = read.table("../../Body/2Derived/harvest.txt", header = TRUE)
names(data)
### 1 keep only 37
table(data$temp)
nrow(data) # 243476
data = data[data$temp == 37,]
nrow(data) # 81157
### 2 keep only normal tRNA
length(table(data$trna)) # 23 becaus there is 'local' ???
data[data$trna == 'local',]
nrow(data)
data = data[data$trna != 'local',]
nrow(data)
### 3 keep only tRNA with estimated Gibbs Energy (not NA)
str(data)
nrow(data)
data = data[!is.na(data$gibbs),]
nrow(data)
summary(data$gibbs)
### 4 keep only mammals and derive Longlived (!!!!!! not ideal!!!!)
Mammals = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", sep = '\t', header = TRUE)
Mammals$species = gsub(' ','_',Mammals$Scientific_name)
Mammals = Mammals[names(Mammals) %in% c('species','GenerationLength_d')]
quartile(Mammals$GenerationLength_d,0.5)
quantile(Mammals$GenerationLength_d,0.5)
ThresholdGenLength = quantile(Mammals$GenerationLength_d,0.75)
Mammals$LongLived = 1
for (i in 1:nrow(Mammals))  { if (Mammals$GenerationLength_d[i] <= ThresholdGenLength) {Mammals$LongLived[i] = 0} }
table(Mammals$LongLived)
nrow(data)
data = merge(data,Mammals, by = 'species')
nrow(data)/22 # ~ 432 species
Annot = read.table("../../Body/2Derived/MammalianTrnaManualAnnotation.txt", sep = '\t', header = TRUE)
Annot$GeneCodedOnLightChain = as.numeric(as.factor(Annot$Chain))-1 # heavy = 0; light = 1
Annot = Annot[colnames(Annot) %in% c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll')]
nrow(data)
data = merge(data,Annot, by = 'trna')
nrow(data)
### 6 average Gibbs Energy for each tRNA
agg = aggregate(data$gibbs, by = list(data$trna,data$GeneCodedOnLightChain,data$TimeBeingSingleStrangedForAll), FUN = median)
names(agg) = c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll','MedianGibbs')
agg = agg[order(agg$MedianGibbs),]
### 7 analysis with 22 values
summary(lm(-MedianGibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll, data = agg))
# if GeneCodedOnLightChain == 1, it means that tRNA after transcription is identical to heavy chain => G and T rich (due to to common transitions: A>G, C>T)
# althougth non-significant, TimeBeingSingleStrangedForAll has positive coefficient, which is expected
summary(lm(-MedianGibbs ~ GeneCodedOnLightChain*TimeBeingSingleStrangedForAll, data = agg)) # no interaction
### 8 analysis with whole dataset
summary(lm(-gibbs ~ GeneCodedOnLightChain+TimeBeingSingleStrangedForAll, data = data)) # strong effect of all
# to do 1: introduce species factor into the model. glm
# to do 2: introduce species as species-specific generation length
# to do 3: PICs
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + log2(GenerationLength_d), data = data)) # PIC
summary(lm(-gibbs ~ (GeneCodedOnLightChain + TimeBeingSingleStrangedForAll)*log2(GenerationLength_d), data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + LongLived, data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll*LongLived, data = data))
###################################
rm(list=ls(all=TRUE))
data = read.table("../../Body/2Derived/harvest.txt", header = TRUE)
names(data)
### 1 keep only 37
table(data$temp)
nrow(data) # 243476
data = data[data$temp == 37,]
nrow(data) # 81157
### 2 keep only normal tRNA
length(table(data$trna)) # 23 becaus there is 'local' ???
data[data$trna == 'local',]
nrow(data)
data = data[data$trna != 'local',]
nrow(data)
### 3 keep only tRNA with estimated Gibbs Energy (not NA)
str(data)
nrow(data)
data = data[!is.na(data$gibbs),]
nrow(data)
summary(data$gibbs)
### 4 keep only mammals and derive Longlived (!!!!!! not ideal!!!!)
Mammals = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", sep = '\t', header = TRUE)
Mammals$species = gsub(' ','_',Mammals$Scientific_name)
Mammals = Mammals[names(Mammals) %in% c('species','GenerationLength_d')]
ThresholdGenLength = quantile(Mammals$GenerationLength_d,0.25)
Mammals$LongLived = 1
for (i in 1:nrow(Mammals))  { if (Mammals$GenerationLength_d[i] <= ThresholdGenLength) {Mammals$LongLived[i] = 0} }
table(Mammals$LongLived)
nrow(data)
data = merge(data,Mammals, by = 'species')
nrow(data)/22 # ~ 432 species
### 5 read annotation and merge with data
Annot = read.table("../../Body/2Derived/MammalianTrnaManualAnnotation.txt", sep = '\t', header = TRUE)
Annot$GeneCodedOnLightChain = as.numeric(as.factor(Annot$Chain))-1 # heavy = 0; light = 1
Annot = Annot[colnames(Annot) %in% c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll')]
nrow(data)
data = merge(data,Annot, by = 'trna')
nrow(data)
### 6 average Gibbs Energy for each tRNA
agg = aggregate(data$gibbs, by = list(data$trna,data$GeneCodedOnLightChain,data$TimeBeingSingleStrangedForAll), FUN = median)
names(agg) = c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll','MedianGibbs')
agg = agg[order(agg$MedianGibbs),]
### 7 analysis with 22 values
summary(lm(-MedianGibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll, data = agg))
# if GeneCodedOnLightChain == 1, it means that tRNA after transcription is identical to heavy chain => G and T rich (due to to common transitions: A>G, C>T)
# althougth non-significant, TimeBeingSingleStrangedForAll has positive coefficient, which is expected
summary(lm(-MedianGibbs ~ GeneCodedOnLightChain*TimeBeingSingleStrangedForAll, data = agg)) # no interaction
### 8 analysis with whole dataset
summary(lm(-gibbs ~ GeneCodedOnLightChain+TimeBeingSingleStrangedForAll, data = data)) # strong effect of all
# to do 1: introduce species factor into the model. glm
# to do 2: introduce species as species-specific generation length
# to do 3: PICs
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + log2(GenerationLength_d), data = data)) # PIC
summary(lm(-gibbs ~ (GeneCodedOnLightChain + TimeBeingSingleStrangedForAll)*log2(GenerationLength_d), data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + LongLived, data = data))
###################################
rm(list=ls(all=TRUE))
data = read.table("../../Body/2Derived/harvest.txt", header = TRUE)
names(data)
### 1 keep only 37
table(data$temp)
nrow(data) # 243476
data = data[data$temp == 37,]
nrow(data) # 81157
### 2 keep only normal tRNA
length(table(data$trna)) # 23 becaus there is 'local' ???
data[data$trna == 'local',]
nrow(data)
data = data[data$trna != 'local',]
nrow(data)
### 3 keep only tRNA with estimated Gibbs Energy (not NA)
str(data)
nrow(data)
data = data[!is.na(data$gibbs),]
nrow(data)
summary(data$gibbs)
### 4 keep only mammals and derive Longlived (!!!!!! not ideal!!!!)
Mammals = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", sep = '\t', header = TRUE)
Mammals$species = gsub(' ','_',Mammals$Scientific_name)
Mammals = Mammals[names(Mammals) %in% c('species','GenerationLength_d')]
ThresholdGenLength = quantile(Mammals$GenerationLength_d,0.10) # this work better than 0.5 or 0.75 => don't know why
Mammals$LongLived = 1
for (i in 1:nrow(Mammals))  { if (Mammals$GenerationLength_d[i] <= ThresholdGenLength) {Mammals$LongLived[i] = 0} }
table(Mammals$LongLived)
nrow(data)
data = merge(data,Mammals, by = 'species')
nrow(data)/22 # ~ 432 species
### 5 read annotation and merge with data
Annot = read.table("../../Body/2Derived/MammalianTrnaManualAnnotation.txt", sep = '\t', header = TRUE)
Annot$GeneCodedOnLightChain = as.numeric(as.factor(Annot$Chain))-1 # heavy = 0; light = 1
Annot = Annot[colnames(Annot) %in% c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll')]
nrow(data)
data = merge(data,Annot, by = 'trna')
nrow(data)
### 6 average Gibbs Energy for each tRNA
agg = aggregate(data$gibbs, by = list(data$trna,data$GeneCodedOnLightChain,data$TimeBeingSingleStrangedForAll), FUN = median)
names(agg) = c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll','MedianGibbs')
agg = agg[order(agg$MedianGibbs),]
### 7 analysis with 22 values
summary(lm(-MedianGibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll, data = agg))
# if GeneCodedOnLightChain == 1, it means that tRNA after transcription is identical to heavy chain => G and T rich (due to to common transitions: A>G, C>T)
# althougth non-significant, TimeBeingSingleStrangedForAll has positive coefficient, which is expected
summary(lm(-MedianGibbs ~ GeneCodedOnLightChain*TimeBeingSingleStrangedForAll, data = agg)) # no interaction
### 8 analysis with whole dataset
summary(lm(-gibbs ~ GeneCodedOnLightChain+TimeBeingSingleStrangedForAll, data = data)) # strong effect of all
# to do 1: introduce species factor into the model. glm
# to do 2: introduce species as species-specific generation length
# to do 3: PICs
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + log2(GenerationLength_d), data = data)) # PIC
summary(lm(-gibbs ~ (GeneCodedOnLightChain + TimeBeingSingleStrangedForAll)*log2(GenerationLength_d), data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + LongLived, data = data))
###################################
rm(list=ls(all=TRUE))
data = read.table("../../Body/2Derived/harvest.txt", header = TRUE)
names(data)
### 1 keep only 37
table(data$temp)
nrow(data) # 243476
data = data[data$temp == 37,]
nrow(data) # 81157
### 2 keep only normal tRNA
length(table(data$trna)) # 23 becaus there is 'local' ???
data[data$trna == 'local',]
nrow(data)
data = data[data$trna != 'local',]
nrow(data)
### 3 keep only tRNA with estimated Gibbs Energy (not NA)
str(data)
nrow(data)
data = data[!is.na(data$gibbs),]
nrow(data)
summary(data$gibbs)
### 4 keep only mammals and derive Longlived (!!!!!! not ideal!!!!)
Mammals = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", sep = '\t', header = TRUE)
Mammals$species = gsub(' ','_',Mammals$Scientific_name)
Mammals = Mammals[names(Mammals) %in% c('species','GenerationLength_d')]
ThresholdGenLength = quantile(Mammals$GenerationLength_d,0.25) # this work better than 0.5 or 0.75 => don't know why
Mammals$LongLived = 1
for (i in 1:nrow(Mammals))  { if (Mammals$GenerationLength_d[i] <= ThresholdGenLength) {Mammals$LongLived[i] = 0} }
table(Mammals$LongLived)
nrow(data)
data = merge(data,Mammals, by = 'species')
nrow(data)/22 # ~ 432 species
### 5 read annotation and merge with data
Annot = read.table("../../Body/2Derived/MammalianTrnaManualAnnotation.txt", sep = '\t', header = TRUE)
Annot$GeneCodedOnLightChain = as.numeric(as.factor(Annot$Chain))-1 # heavy = 0; light = 1
Annot = Annot[colnames(Annot) %in% c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll')]
nrow(data)
data = merge(data,Annot, by = 'trna')
nrow(data)
### 6 average Gibbs Energy for each tRNA
agg = aggregate(data$gibbs, by = list(data$trna,data$GeneCodedOnLightChain,data$TimeBeingSingleStrangedForAll), FUN = median)
names(agg) = c('trna','GeneCodedOnLightChain','TimeBeingSingleStrangedForAll','MedianGibbs')
agg = agg[order(agg$MedianGibbs),]
### 7 analysis with 22 values
summary(lm(-MedianGibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll, data = agg))
# if GeneCodedOnLightChain == 1, it means that tRNA after transcription is identical to heavy chain => G and T rich (due to to common transitions: A>G, C>T)
# althougth non-significant, TimeBeingSingleStrangedForAll has positive coefficient, which is expected
summary(lm(-MedianGibbs ~ GeneCodedOnLightChain*TimeBeingSingleStrangedForAll, data = agg)) # no interaction
### 8 analysis with whole dataset
summary(lm(-gibbs ~ GeneCodedOnLightChain+TimeBeingSingleStrangedForAll, data = data)) # strong effect of all
# to do 1: introduce species factor into the model. glm
# to do 2: introduce species as species-specific generation length
# to do 3: PICs
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + log2(GenerationLength_d), data = data)) # PIC
summary(lm(-gibbs ~ (GeneCodedOnLightChain + TimeBeingSingleStrangedForAll)*log2(GenerationLength_d), data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + LongLived, data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll*LongLived, data = data))
summary(lm(-gibbs ~ GeneCodedOnLightChain + TimeBeingSingleStrangedForAll + LongLived, data = data))  #### !!!!!!!!!!
summary(lm(-gibbs ~ scale(GeneCodedOnLightChain) + scale(TimeBeingSingleStrangedForAll) + scale(LongLived), data = data))  #### !!!!!!!!!!
summary(lm(-scale(gibbs) ~ scale(GeneCodedOnLightChain) + scale(TimeBeingSingleStrangedForAll) + scale(LongLived), data = data))  #### !!!!!!!!!!
summary(lm(-scale(gibbs) ~ 0 + scale(GeneCodedOnLightChain) + scale(TimeBeingSingleStrangedForAll) + scale(LongLived), data = data))  #### !!!!!!!!!!
summary(lm(-gibbs ~ scale(GeneCodedOnLightChain) + scale(TimeBeingSingleStrangedForAll) + scale(LongLived), data = data))  #### !!!!!!!!!!
